<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>TKFM Records HQ ‚Äî They Krave For Me Radio</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="TKFM Records HQ ‚Äî label control center for applications, contracts, roster, spotlights and sponsors, wired to TKFM v2 local brain keys." />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/js/logo-check.js" defer></script>
  <style>
    body{
      background:#020617;
      background-image:
        radial-gradient(circle at 0 0,rgba(250,204,21,0.18),transparent 55%),
        radial-gradient(circle at 100% 0,rgba(251,191,36,0.18),transparent 55%),
        radial-gradient(circle at 50% 100%,rgba(248,250,252,0.06),transparent 55%);
    }
    ::-webkit-scrollbar{height:6px;width:6px;}
    ::-webkit-scrollbar-thumb{background:#4b5563;border-radius:999px;}
    .glass{
      background-color:rgba(15,23,42,0.96);
      backdrop-filter:blur(22px);
    }
    .marble{
      background-image:
        radial-gradient(circle at 10% 0%,rgba(248,250,252,0.12),transparent 55%),
        radial-gradient(circle at 90% 0%,rgba(15,23,42,0.96),transparent 55%),
        radial-gradient(circle at 0% 100%,rgba(15,23,42,0.96),transparent 55%),
        radial-gradient(circle at 100% 100%,rgba(15,23,42,0.96),transparent 55%);
      background-color:#020617;
    }
  </style>
</head>
<body class="text-slate-50 min-h-screen flex flex-col">

  <!-- NAV -->
  <header class="w-full border-b border-yellow-500/30 bg-black/80 backdrop-blur-xl sticky top-0 z-40">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-4">
      <a href="index.html" class="flex items-center gap-3">
        <img src="/tkfm-records-logo.png" alt="TKFM Records" class="h-9 w-auto object-contain" />
        <div class="leading-tight">
          <div class="text-[0.6rem] uppercase tracking-[0.35em] text-yellow-400/80">
            TKFM Records
          </div>
          <div class="text-sm font-semibold">
            Label HQ <span class="text-yellow-300">Control Room</span>
          </div>
        </div>
      </a>
      <nav class="ml-auto flex flex-wrap gap-2 text-[0.7rem] uppercase tracking-[0.22em]">
        <a href="radio-hub.html" class="px-3 py-1 rounded-full border border-slate-700/80 bg-slate-950/80 text-slate-100 flex items-center gap-1">
          <span>üìª</span><span>Radio Hub</span>
        </a>
        <a href="records-application.html" class="px-3 py-1 rounded-full border border-yellow-400/80 bg-yellow-400/10 text-yellow-200 flex items-center gap-1">
          <span>üìù</span><span>Apply</span>
        </a>
        <a href="label-records-applications.html" class="px-3 py-1 rounded-full border border-amber-400/80 bg-amber-400/10 text-amber-200 flex items-center gap-1">
          <span>üìÇ</span><span>Queue</span>
        </a>
        <a href="label-contract-lab.html" class="px-3 py-1 rounded-full border border-emerald-400/80 bg-emerald-400/10 text-emerald-200 flex items-center gap-1">
          <span>üìú</span><span>Contract Lab</span>
        </a>
        <a href="label-mixtape-spotlight.html" class="px-3 py-1 rounded-full border border-fuchsia-400/80 bg-fuchsia-400/10 text-fuchsia-200 flex items-center gap-1">
          <span>üåü</span><span>Spotlight</span>
        </a>
        <a href="label-sponsor-engine.html" class="px-3 py-1 rounded-full border border-yellow-500/80 bg-yellow-500/10 text-yellow-100 flex items-center gap-1">
          <span>üè¶</span><span>Sponsors</span>
        </a>
        <a href="god-view.html" class="px-3 py-1 rounded-full border border-emerald-300/80 bg-emerald-300/10 text-emerald-200 flex items-center gap-1">
          <span>üëÅ</span><span>GOD VIEW</span>
        </a>
      </nav>
    </div>
  </header>

  <!-- MAIN -->
  <main class="flex-1">
    <section class="max-w-6xl mx-auto px-4 pt-8 pb-12 space-y-7">

      <!-- HERO -->
      <section class="space-y-3">
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-yellow-400/80 bg-yellow-400/10 text-[0.7rem] uppercase tracking-[0.3em] text-yellow-200">
          <span class="w-1.5 h-1.5 rounded-full bg-emerald-400 animate-pulse"></span>
          TKFM Records ‚Ä¢ Label HQ
        </div>
        <h1 class="text-3xl md:text-4xl font-extrabold leading-tight">
          The <span class="text-yellow-300 drop-shadow-[0_0_26px_rgba(250,204,21,0.9)]">label brain</span> for the Independent Artist Power Station.
        </h1>
        <p class="text-sm md:text-base text-slate-100/90 max-w-2xl">
          Track **applications, contracts, roster, spotlights and sponsors** from one marble-glass
          control room ‚Äî all powered by TKFM v2 local label keys.
        </p>
        <p class="text-[0.78rem] text-slate-300 max-w-xl">
          Keys read:
          <span class="font-mono text-yellow-300 text-[0.75rem]">tkfm_label_applications</span>,
          <span class="font-mono text-yellow-300 text-[0.75rem]">tkfm_label_roster</span>,
          <span class="font-mono text-yellow-300 text-[0.75rem]">tkfm_label_spotlight</span>,
          <span class="font-mono text-yellow-300 text-[0.75rem]">tkfm_contract_latest</span>,
          <span class="font-mono text-yellow-300 text-[0.75rem]">tkfm_label_revenue</span>,
          <span class="font-mono text-yellow-300 text-[0.75rem]">sponsors</span>.
        </p>
      </section>

      <!-- ROW 1: SNAPSHOT ‚Ä¢ PIPELINE ‚Ä¢ CONTRACT -->
      <section class="grid gap-4 lg:grid-cols-3">

        <!-- SNAPSHOT -->
        <aside class="rounded-3xl border border-yellow-500/40 glass marble relative overflow-hidden">
          <div class="pointer-events-none absolute -inset-20 opacity-40 blur-3xl bg-[conic-gradient(from_120deg,_#facc15,_#f97316,_#fef9c3,_#facc15)]"></div>
          <div class="relative p-4 space-y-3 text-sm h-full flex flex-col">
            <div class="flex items-center justify-between gap-3">
              <div>
                <p class="text-[0.7rem] uppercase tracking-[0.3em] text-yellow-200/80 mb-1">
                  Label Snapshot (This Device)
                </p>
                <p class="text-xs text-slate-100">
                  Local-only in dev. In production this would mirror the shared label database.
                </p>
              </div>
              <button id="lh-refresh" class="px-2.5 py-1 rounded-full border border-yellow-300/80 bg-yellow-300/10 text-[0.65rem] uppercase tracking-[0.22em] text-yellow-100">
                Refresh
              </button>
            </div>

            <div class="grid grid-cols-3 gap-3 text-xs mt-1">
              <div>
                <p class="text-slate-100 mb-0.5">Applications</p>
                <p id="lh-app-count" class="text-lg font-bold text-yellow-300">0</p>
              </div>
              <div>
                <p class="text-slate-100 mb-0.5">Signed Roster</p>
                <p id="lh-roster-count" class="text-lg font-bold text-emerald-300">0</p>
              </div>
              <div>
                <p class="text-slate-100 mb-0.5">Spotlights</p>
                <p id="lh-spotlight-count" class="text-lg font-bold text-fuchsia-300">0</p>
              </div>
            </div>

            <div class="grid grid-cols-2 gap-3 text-xs">
              <div>
                <p class="text-slate-100 mb-0.5">Sponsors</p>
                <p id="lh-sponsor-count" class="text-lg font-bold text-amber-300">0</p>
              </div>
              <div>
                <p class="text-slate-100 mb-0.5">Contracts</p>
                <p id="lh-contract-status" class="text-lg font-bold text-slate-100">0</p>
              </div>
            </div>

            <p id="lh-revenue-note" class="text-[0.72rem] text-slate-200 mt-auto">
              Label revenue snapshot: dev-only. Use <span class="font-mono text-yellow-200 text-[0.72rem]">tkfm_label_revenue</span> to store totals / projections.
            </p>
          </div>
        </aside>

        <!-- PIPELINE -->
        <article class="rounded-3xl border border-yellow-500/30 glass p-4 md:p-5 text-sm space-y-3 h-full flex flex-col">
          <header class="flex items-center justify-between gap-2">
            <div>
              <p class="text-[0.7rem] uppercase tracking-[0.3em] text-yellow-200/80">
                TKFM Records Pipeline
              </p>
              <h2 class="text-sm font-semibold text-slate-50">
                Applications ‚Üí Review ‚Üí Contract ‚Üí Roster ‚Üí Spotlight ‚Üí Autopilot.
              </h2>
            </div>
            <span class="text-xl">üèõ</span>
          </header>

          <p class="text-[0.8rem] text-slate-200">
            Each step has its own tool. This column shows the **flow** ‚Äî click into any tile
            to work that stage.
          </p>

          <div class="grid gap-3 text-[0.78rem] mt-2">
            <div class="grid gap-2 sm:grid-cols-2">
              <a href="records-application.html" class="rounded-2xl border border-yellow-500/40 bg-yellow-500/10 px-3 py-3 flex flex-col gap-1 hover:bg-yellow-500/15 transition">
                <p class="text-[0.7rem] uppercase tracking-[0.22em] text-yellow-200/90">1. Application</p>
                <p class="text-[0.8rem] font-semibold text-slate-50">Artist applies</p>
                <p class="text-[0.72rem] text-slate-200">
                  Form drops into <span class="font-mono text-yellow-200 text-[0.7rem]">tkfm_label_applications</span>.
                </p>
              </a>

              <a href="label-records-applications.html" class="rounded-2xl border border-slate-700 bg-slate-950/90 px-3 py-3 flex flex-col gap-1 hover:bg-slate-900 transition">
                <p class="text-[0.7rem] uppercase tracking-[0.22em] text-slate-300">2. Review</p>
                <p class="text-[0.8rem] font-semibold text-slate-50">Queue & tags</p>
                <p class="text-[0.72rem] text-slate-300">
                  Filter by fit, heat, genre. Approve / decline.
                </p>
              </a>
            </div>

            <div class="grid gap-2 sm:grid-cols-2">
              <a href="label-contract-lab.html" class="rounded-2xl border border-emerald-500/40 bg-emerald-500/10 px-3 py-3 flex flex-col gap-1 hover:bg-emerald-500/15 transition">
                <p class="text-[0.7rem] uppercase tracking-[0.22em] text-emerald-200/90">3. Contract</p>
                <p class="text-[0.8rem] font-semibold text-slate-50">Deal terms</p>
                <p class="text-[0.72rem] text-slate-200">
                  AI lab saves drafts to <span class="font-mono text-emerald-200 text-[0.7rem]">tkfm_contract_latest</span>.
                </p>
              </a>

              <a href="label-accounts.html" class="rounded-2xl border border-slate-700 bg-slate-950/90 px-3 py-3 flex flex-col gap-1 hover:bg-slate-900 transition">
                <p class="text-[0.7rem] uppercase tracking-[0.22em] text-slate-300">4. Roster</p>
                <p class="text-[0.8rem] font-semibold text-slate-50">Onboarded</p>
                <p class="text-[0.72rem] text-slate-300">
                  Signed artists saved in <span class="font-mono text-yellow-200 text-[0.7rem]">tkfm_label_roster</span>.
                </p>
              </a>
            </div>

            <a href="label-mixtape-spotlight.html" class="rounded-2xl border border-fuchsia-500/40 bg-fuchsia-500/10 px-3 py-3 flex flex-col gap-1 hover:bg-fuchsia-500/15 transition">
              <p class="text-[0.7rem] uppercase tracking-[0.22em] text-fuchsia-200/90">5. Spotlight</p>
              <p class="text-[0.8rem] font-semibold text-slate-50">Boost & rotation</p>
              <p class="text-[0.72rem] text-slate-200">
                Picks feed Autopilot weighting via <span class="font-mono text-fuchsia-200 text-[0.7rem]">tkfm_label_spotlight</span>.
              </p>
            </a>
          </div>
        </article>

        <!-- CONTRACT SNAPSHOT -->
        <article class="rounded-3xl border border-yellow-500/30 glass p-4 md:p-5 text-sm space-y-3 h-full flex flex-col">
          <header class="flex items-center justify-between gap-2">
            <div>
              <p class="text-[0.7rem] uppercase tracking-[0.3em] text-yellow-200/80">
                Contract Snapshot
              </p>
              <h2 class="text-sm font-semibold text-slate-50">
                Latest deal coming out of Contract Lab.
              </h2>
            </div>
            <a href="label-contract-output.html" class="text-[0.75rem] px-3 py-1 rounded-full border border-yellow-400/80 bg-yellow-400/10 text-yellow-100 flex items-center gap-1">
              <span>View output</span><span>‚Üó</span>
            </a>
          </header>

          <div id="lh-contract-empty" class="text-[0.8rem] text-slate-200">
            No contract found in <span class="font-mono text-yellow-200 text-[0.75rem]">tkfm_contract_latest</span> yet.  
            Use the Contract Lab to generate or update a deal.
          </div>

          <div id="lh-contract-card" class="hidden rounded-2xl border border-yellow-500/40 bg-black/70 px-3 py-3 text-[0.8rem] space-y-2 mt-1 flex-1">
            <p id="lh-contract-artist" class="text-sm font-semibold text-slate-50">
              <!-- artist -->
            </p>
            <p id="lh-contract-summary" class="text-[0.8rem] text-slate-100">
              <!-- summary -->
            </p>
            <p id="lh-contract-terms" class="text-[0.75rem] text-slate-300">
              <!-- terms -->
            </p>
            <p id="lh-contract-updated" class="text-[0.7rem] text-slate-400">
              <!-- date -->
            </p>
          </div>
        </article>
      </section>

      <!-- ROW 2: APPLICATIONS ‚Ä¢ ROSTER/SPOTLIGHT -->
      <section class="grid gap-4 lg:grid-cols-[minmax(0,1.1fr)_minmax(0,1fr)]">

        <!-- APPLICATION FEED -->
        <article class="rounded-3xl border border-yellow-500/20 glass p-4 md:p-6 text-sm space-y-3">
          <header class="flex items-center justify-between gap-2">
            <div>
              <p class="text-[0.7rem] uppercase tracking-[0.3em] text-yellow-200/80">
                Latest Label Applications
              </p>
              <h2 class="text-sm font-semibold text-slate-50">
                Who‚Äôs knocking on TKFM Records‚Äô door.
              </h2>
            </div>
            <span class="text-xl">üìÇ</span>
          </header>

          <div id="lh-apps-empty" class="text-[0.8rem] text-slate-200">
            No applications stored yet. Records application forms will show up here
            once they‚Äôre saved into <span class="font-mono text-yellow-200 text-[0.75rem]">tkfm_label_applications</span>.
          </div>

          <div id="lh-apps-list" class="hidden space-y-1.5 text-[0.78rem] max-h-56 overflow-y-auto">
            <!-- filled by JS -->
          </div>
        </article>

        <!-- ROSTER + SPOTLIGHT -->
        <article class="rounded-3xl border border-yellow-500/20 glass p-4 md:p-6 text-sm space-y-4">
          <header class="flex items-center justify-between gap-2">
            <div>
              <p class="text-[0.7rem] uppercase tracking-[0.3em] text-yellow-200/80">
                Roster & Spotlight
              </p>
              <h2 class="text-sm font-semibold text-slate-50">
                Who‚Äôs officially TKFM Records ‚Äî and who‚Äôs glowing.
              </h2>
            </div>
            <span class="text-xl">üåü</span>
          </header>

          <div>
            <p class="text-[0.7rem] uppercase tracking-[0.22em] text-slate-300 mb-1">
              Signed Roster
            </p>
            <div id="lh-roster-empty" class="text-[0.78rem] text-slate-200">
              No roster found yet. Use label onboarding / accounts flows to push artists into
              <span class="font-mono text-yellow-200 text-[0.75rem]">tkfm_label_roster</span>.
            </div>
            <div id="lh-roster-list" class="hidden space-y-1.5 text-[0.78rem] max-h-32 overflow-y-auto">
              <!-- roster -->
            </div>
          </div>

          <div>
            <p class="text-[0.7rem] uppercase tracking-[0.22em] text-slate-300 mb-1">
              Spotlight Picks
            </p>
            <div id="lh-spotlight-empty" class="text-[0.78rem] text-slate-200">
              No spotlight entries yet. Label spotlight tools can store picks into
              <span class="font-mono text-yellow-200 text-[0.75rem]">tkfm_label_spotlight</span>.
            </div>
            <div id="lh-spotlight-list" class="hidden space-y-1.5 text-[0.78rem] max-h-32 overflow-y-auto">
              <!-- spotlight -->
            </div>
          </div>
        </article>
      </section>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="border-t border-yellow-500/20 bg-black/80">
    <div class="max-w-6xl mx-auto px-4 py-4 text-[0.7rem] text-slate-300 flex flex-wrap gap-3 items-center">
      <span>¬© 2025 TKFM Records ‚Äî Label HQ.</span>
      <span class="opacity-80">
        Built on TKFM v2 local label keys. In production, point the same UI at a shared label backend.
      </span>
    </div>
  </footer>

  <script>
    // ---------- helpers ----------
    function lhSafeParse(key, fallback) {
      try {
        const raw = localStorage.getItem(key);
        if (!raw) return fallback;
        const parsed = JSON.parse(raw);
        return parsed ?? fallback;
      } catch (e) {
        console.warn('LabelHome parse fail', key, e);
        return fallback;
      }
    }
    function lhArr(key) {
      const v = lhSafeParse(key, []);
      return Array.isArray(v) ? v : [];
    }
    function lhEscape(str) {
      return String(str || '')
        .replace(/&/g,'&amp;')
        .replace(/</g,'&lt;')
        .replace(/>/g,'&gt;')
        .replace(/"/g,'&quot;')
        .replace(/'/g,'&#039;');
    }
    function lhPrettyDate(iso) {
      if (!iso) return '';
      const d = new Date(iso);
      if (Number.isNaN(d.getTime())) return '';
      return d.toLocaleString();
    }

    function renderSnapshot() {
      const apps      = lhArr('tkfm_label_applications');
      const roster    = lhArr('tkfm_label_roster');
      const spotlight = lhArr('tkfm_label_spotlight');
      const sponsors  = lhArr('sponsors');

      document.getElementById('lh-app-count').textContent       = apps.length;
      document.getElementById('lh-roster-count').textContent    = roster.length;
      document.getElementById('lh-spotlight-count').textContent = spotlight.length;
      document.getElementById('lh-sponsor-count').textContent   = sponsors.length;

      const contract = lhSafeParse('tkfm_contract_latest', null);
      const statusEl = document.getElementById('lh-contract-status');
      statusEl.textContent = contract ? '1' : '0';

      const revenue = lhSafeParse('tkfm_label_revenue', null);
      const noteEl = document.getElementById('lh-revenue-note');
      if (!revenue) {
        noteEl.textContent =
          'Label revenue snapshot: dev-only. Use "tkfm_label_revenue" to store totals / projections (e.g., deal count, projected royalties).';
      } else {
        const parts = [];
        Object.keys(revenue).forEach(k => {
          parts.push(k + ': ' + revenue[k]);
        });
        noteEl.textContent = 'Label revenue snapshot ‚Äî ' + parts.join(' ‚Ä¢ ');
      }
    }

    function renderContract() {
      const raw = lhSafeParse('tkfm_contract_latest', null);
      const empty = document.getElementById('lh-contract-empty');
      const card  = document.getElementById('lh-contract-card');

      if (!raw) {
        empty.classList.remove('hidden');
        card.classList.add('hidden');
        return;
      }

      empty.classList.add('hidden');
      card.classList.remove('hidden');

      let data = raw;
      if (typeof raw === 'string') {
        try {
          data = JSON.parse(raw);
        } catch {
          data = { body: raw };
        }
      }

      const artist = data.artistName || data.artist || data.clientName || 'Artist / Client';
      const summary = data.summary ||
        data.dealSummary ||
        'Latest contract generated in Contract Lab.';
      const terms = data.terms ||
        data.keyTerms ||
        (data.body && data.body.slice(0, 220) + (data.body.length > 220 ? '‚Ä¶' : '')) ||
        'Terms preview not available.';
      const updated = lhPrettyDate(data.updatedAt || data.createdAt || data.timestamp);

      document.getElementById('lh-contract-artist').textContent = artist;
      document.getElementById('lh-contract-summary').textContent = summary;
      document.getElementById('lh-contract-terms').textContent = terms;
      document.getElementById('lh-contract-updated').textContent =
        updated ? 'Last touch: ' + updated : '';
    }

    function renderApplications() {
      const apps = lhArr('tkfm_label_applications').slice().reverse();
      const empty = document.getElementById('lh-apps-empty');
      const list  = document.getElementById('lh-apps-list');

      if (!apps.length) {
        empty.classList.remove('hidden');
        list.classList.add('hidden');
        list.innerHTML = '';
        return;
      }

      empty.classList.add('hidden');
      list.classList.remove('hidden');

      list.innerHTML = apps.slice(0, 12).map(a => {
        const name   = a.artistName || a.name || 'Unknown Artist';
        const city   = a.city || '';
        const genre  = a.genre || '';
        const status = a.status || 'Pending';
        const ts     = lhPrettyDate(a.createdAt || a.timestamp);

        const tags = [];
        if (genre)  tags.push('#' + genre);
        if (status) tags.push(status);

        return (
          '<div class="flex items-start gap-2">' +
            '<span class="text-[0.7rem] text-yellow-300 mt-[3px]">‚Ä¢</span>' +
            '<div class="min-w-0 flex-1">' +
              '<p class="text-[0.8rem] font-semibold truncate">' + lhEscape(name) + '</p>' +
              '<p class="text-[0.75rem] text-slate-200 truncate">' +
                (city ? lhEscape(city) : 'Location: n/a') +
              '</p>' +
              '<p class="text-[0.7rem] text-slate-300 truncate">' +
                (tags.length ? lhEscape(tags.join(' ‚Ä¢ ')) : '') +
                (ts ? (tags.length ? ' ‚Ä¢ ' : '') + lhEscape(ts) : '') +
              '</p>' +
            '</div>' +
          '</div>'
        );
      }).join('');
    }

    function renderRoster() {
      const roster = lhArr('tkfm_label_roster').slice().reverse();
      const empty = document.getElementById('lh-roster-empty');
      const list  = document.getElementById('lh-roster-list');

      if (!roster.length) {
        empty.classList.remove('hidden');
        list.classList.add('hidden');
        list.innerHTML = '';
        return;
      }

      empty.classList.add('hidden');
      list.classList.remove('hidden');

      list.innerHTML = roster.slice(0, 8).map(r => {
        const name   = r.artistName || r.name || 'Unknown Artist';
        const city   = r.city || '';
        const deal   = r.dealType || r.deal || '';
        const tag    = r.tag || r.focus || '';
        const joined = lhPrettyDate(r.joinedAt || r.createdAt || r.timestamp);

        const parts = [];
        if (deal) parts.push(deal);
        if (tag)  parts.push(tag);

        return (
          '<div class="flex items-start gap-2">' +
            '<span class="text-[0.7rem] text-emerald-300 mt-[3px]">‚Ä¢</span>' +
            '<div class="min-w-0 flex-1">' +
              '<p class="text-[0.8rem] font-semibold truncate">' + lhEscape(name) + '</p>' +
              '<p class="text-[0.75rem] text-slate-200 truncate">' +
                (city ? lhEscape(city) : 'Location: n/a') +
              '</p>' +
              '<p class="text-[0.7rem] text-slate-300 truncate">' +
                (parts.length ? lhEscape(parts.join(' ‚Ä¢ ')) : '') +
                (joined ? (parts.length ? ' ‚Ä¢ ' : '') + lhEscape(joined) : '') +
              '</p>' +
            '</div>' +
          '</div>'
        );
      }).join('');
    }

    function renderSpotlight() {
      const picks = lhArr('tkfm_label_spotlight').slice().reverse();
      const empty = document.getElementById('lh-spotlight-empty');
      const list  = document.getElementById('lh-spotlight-list');

      if (!picks.length) {
        empty.classList.remove('hidden');
        list.classList.add('hidden');
        list.innerHTML = '';
        return;
      }

      empty.classList.add('hidden');
      list.classList.remove('hidden');

      list.innerHTML = picks.slice(0, 8).map(p => {
        const title  = p.projectTitle || p.title || 'Spotlight Record';
        const artist = p.artistName || p.artist || 'Unknown Artist';
        const tag    = p.tag || p.mood || '';
        const tier   = p.tier || '';
        const ts     = lhPrettyDate(p.createdAt || p.timestamp);

        const parts = [];
        if (tier) parts.push(tier);
        if (tag)  parts.push(tag);

        return (
          '<div class="flex items-start gap-2">' +
            '<span class="text-[0.7rem] text-fuchsia-300 mt-[3px]">‚Ä¢</span>' +
            '<div class="min-w-0 flex-1">' +
              '<p class="text-[0.8rem] font-semibold truncate">' + lhEscape(title) + '</p>' +
              '<p class="text-[0.75rem] text-slate-200 truncate">' + lhEscape(artist) + '</p>' +
              '<p class="text-[0.7rem] text-slate-300 truncate">' +
                (parts.length ? lhEscape(parts.join(' ‚Ä¢ ')) : '') +
                (ts ? (parts.length ? ' ‚Ä¢ ' : '') + lhEscape(ts) : '') +
              '</p>' +
            '</div>' +
          '</div>'
        );
      }).join('');
    }

    document.addEventListener('DOMContentLoaded', function () {
      const btnRefresh = document.getElementById('lh-refresh');

      function rerender() {
        renderSnapshot();
        renderContract();
        renderApplications();
        renderRoster();
        renderSpotlight();
      }

      btnRefresh?.addEventListener('click', rerender);

      // initial render
      rerender();
    });
  </script>
</body>
</html>
