<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>TKFM Status — Live Services</title>
  <meta name="robots" content="noindex,nofollow"/>
  <link rel="icon" href="/favicon.ico"/>
  <style>
    :root{
      --bg:#020617; --slate:#0f172a; --text:#e2e8f0; --muted:#94a3b8;
      --n1:#22d3ee; --n2:#a855f7; --n3:#ec4899;
      --ok:#22c55e; --warn:#facc15; --bad:#ef4444;
    }
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text)}
    .wrap{max-width:1100px;margin:0 auto;padding:24px 16px}
    .top{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
    h1{margin:0;font-size:26px;font-weight:950;letter-spacing:.4px}
    .sub{margin-top:8px;color:var(--muted);max-width:900px;line-height:1.5}
    .btn{display:inline-flex;align-items:center;justify-content:center;padding:10px 14px;border-radius:999px;
      font-weight:950;color:var(--bg);text-decoration:none;background:linear-gradient(90deg,var(--n1),var(--n2),var(--n3));
      box-shadow:0 14px 30px rgba(0,0,0,.35)}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px;margin-top:16px}
    .card{border-radius:18px;background:rgba(15,23,42,.55);border:1px solid rgba(148,163,184,.18);padding:14px 14px 12px 14px}
    .k{font-size:12px;color:var(--muted);font-weight:900;letter-spacing:.4px;text-transform:uppercase}
    .h{margin-top:6px;font-size:16px;font-weight:950}
    .p{margin-top:8px;color:var(--muted);font-size:13px;line-height:1.45}
    .row{margin-top:10px;display:flex;gap:10px;align-items:center;justify-content:space-between}
    .pill{display:inline-flex;gap:8px;align-items:center;padding:8px 10px;border-radius:999px;font-weight:950;font-size:12px;
      border:1px solid rgba(148,163,184,.18);background:rgba(2,6,23,.45)}
    .dot{width:10px;height:10px;border-radius:999px;background:rgba(148,163,184,.30)}
    .dot.ok{background:var(--ok)}
    .dot.warn{background:var(--warn)}
    .dot.bad{background:var(--bad)}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:12px;color:#cbd5e1}
    .foot{margin-top:14px;color:var(--muted);font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div>
        <h1>TKFM Status</h1>
        <div class="sub">Quick health check for live services and platform endpoints. This page does not expose secrets.</div>
      </div>
      <a class="btn" href="/index.html">Back to Home</a>
    </div>

    <div class="grid">
      <div class="card" data-url="/.netlify/functions/_health">
        <div class="k">Functions</div>
        <div class="h">Netlify Functions Router</div>
        <div class="p"><code>/.netlify/functions/_health</code></div>
        <div class="row">
          <span class="pill"><span class="dot"></span><span class="st">Checking…</span></span>
          <span class="ms">—</span>
        </div>
      </div>

      <div class="card" data-url="/.netlify/functions/pageview-stats">
        <div class="k">Analytics</div>
        <div class="h">Pageview Stats</div>
        <div class="p"><code>/.netlify/functions/pageview-stats</code></div>
        <div class="row">
          <span class="pill"><span class="dot"></span><span class="st">Checking…</span></span>
          <span class="ms">—</span>
        </div>
      </div>

      <div class="card" data-url="/.netlify/functions/price-info?lookup_key=creator_pass_monthly">
        <div class="k">Pricing</div>
        <div class="h">Live Price Info (sample)</div>
        <div class="p"><code>/.netlify/functions/price-info?lookup_key=creator_pass_monthly</code></div>
        <div class="row">
          <span class="pill"><span class="dot"></span><span class="st">Checking…</span></span>
          <span class="ms">—</span>
        </div>
      </div>

      <div class="card" data-url="/tkfm-sitemap.html">
        <div class="k">Navigation</div>
        <div class="h">Sitemap Reachability</div>
        <div class="p"><code>/tkfm-sitemap.html</code></div>
        <div class="row">
          <span class="pill"><span class="dot"></span><span class="st">Checking…</span></span>
          <span class="ms">—</span>
        </div>
      </div>
    </div>

    <div class="foot" id="stamp">Last checked: —</div>
  </div>

  <script type="module" src="/js/tkfm-launch-polish.js"></script>
  <script>
    (function(){
      const cards = Array.from(document.querySelectorAll(".card[data-url]"));
      const stamp = document.getElementById("stamp");

      function set(card, level, text, ms){
        const dot = card.querySelector(".dot");
        const st = card.querySelector(".st");
        const msEl = card.querySelector(".ms");
        dot.classList.remove("ok","warn","bad");
        if (level) dot.classList.add(level);
        st.textContent = text;
        msEl.textContent = ms != null ? (ms + "ms") : "—";
      }

      async function ping(card){
        const url = card.getAttribute("data-url");
        const t0 = performance.now();
        try{
          const res = await fetch(url, { cache: "no-store" });
          const t1 = Math.round(performance.now() - t0);
          if (res.ok) return set(card, "ok", "OK", t1);
          return set(card, "bad", "ERROR " + res.status, t1);
        }catch(e){
          const t1 = Math.round(performance.now() - t0);
          return set(card, "bad", "OFFLINE", t1);
        }
      }

      async function run(){
        for (const c of cards) set(c, null, "Checking…", null);
        for (const c of cards) await ping(c);
        stamp.textContent = "Last checked: " + new Date().toISOString();
      }

      run();
      setInterval(run, 60000);
    })();
  </script>
</body>
</html>
