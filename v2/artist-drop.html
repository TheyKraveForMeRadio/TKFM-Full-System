<!doctype html>
<html lang="en">
<head>
  <meta name="tkfm-theme" content="radio" />
  <link rel="stylesheet" href="/css/tkfm-shell.css" />
  <link rel="stylesheet" href="/css/tkfm-radio.css" />
  <script src="/js/tkfm-shell.js" defer></script>

  <meta charset="utf-8">
  <title>TKFM ‚Äî Artist Drop</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <style>
    :root {
      --bg-deep: #020617;
      --bg-card: rgba(15,23,42,0.98);
      --bg-soft: rgba(17,24,39,0.96);
      --neon-pink: #ec4899;
      --neon-purple: #a855f7;
      --neon-cyan: #22d3ee;
      --neon-blue: #3b82f6;
      --neon-lime: #a3e635;
      --text-main: #f9fafb;
      --text-muted: #94a3b8;
      --text-soft: #64748b;
      --border-subtle: rgba(148,163,184,0.35);
    }

    * { box-sizing:border-box; margin:0; padding:0; }

    body {
      min-height:100vh;
      background:
        radial-gradient(circle at top,#020617 0,transparent 55%),
        radial-gradient(circle at top right,rgba(59,130,246,0.4) 0,transparent 60%),
        radial-gradient(circle at top left,rgba(236,72,153,0.5) 0,transparent 60%),
        linear-gradient(to bottom,#020617,#020617 55%,#000 100%);
      color:var(--text-main);
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",sans-serif;
      -webkit-font-smoothing:antialiased;
      padding:1.6rem .9rem 2.3rem;
      overflow-x:hidden;
    }

    a { color:inherit; text-decoration:none; }

    .shell { max-width:960px; margin:0 auto; }

    /* NAV */
    .nav {
      margin:-1.6rem -.9rem 1.1rem;
      padding:.75rem .9rem;
      background:linear-gradient(to right,rgba(15,23,42,0.98),rgba(17,24,39,0.98));
      border-bottom:1px solid var(--border-subtle);
      backdrop-filter:blur(18px);
      display:flex;
      align-items:center;
      gap:.7rem;
    }
    .nav-left {
      display:flex;
      align-items:center;
      gap:.7rem;
    }
    .logo-orb {
      width:2.3rem;
      height:2.3rem;
      border-radius:999px;
      background:
        radial-gradient(circle at 10% 0,var(--neon-cyan),var(--neon-pink) 40%,var(--neon-purple) 80%);
      box-shadow:
        0 0 20px rgba(236,72,153,.9),
        0 0 22px rgba(59,130,246,.85);
      border:1px solid rgba(236,72,153,.9);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:.7rem;
      font-weight:800;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:#020617;
    }
    .brand-text {
      display:flex;
      flex-direction:column;
      line-height:1.05;
    }
    .brand-kicker {
      font-size:.6rem;
      letter-spacing:.2em;
      text-transform:uppercase;
      color:var(--text-soft);
    }
    .brand-main {
      font-size:.9rem;
      font-weight:650;
    }
    .nav-right {
      margin-left:auto;
      display:flex;
      gap:.4rem;
      flex-wrap:wrap;
    }
    .nav-pill {
      font-size:.64rem;
      text-transform:uppercase;
      letter-spacing:.18em;
      padding:.32rem .7rem;
      border-radius:999px;
      border:1px solid var(--border-subtle);
      background:var(--bg-soft);
      color:var(--text-soft);
      white-space:nowrap;
    }
    .nav-pill.primary {
      border-color:var(--neon-pink);
      color:#020617;
      background:linear-gradient(135deg,var(--neon-pink),var(--neon-purple));
      box-shadow:0 0 18px rgba(236,72,153,.85);
      font-weight:650;
    }

    @media(max-width:900px){
      .nav-right{display:none;}
    }

    /* HEADER */
    .hero {
      margin-bottom:1.1rem;
    }
    .hero-kicker {
      font-size:.7rem;
      text-transform:uppercase;
      letter-spacing:.26em;
      color:var(--text-soft);
      margin-bottom:.4rem;
    }
    .hero-title {
      font-size:clamp(2.1rem,3.4vw,2.4rem);
      font-weight:800;
      line-height:1.04;
      margin-bottom:.3rem;
    }
    .hero-sub {
      font-size:.84rem;
      color:var(--text-muted);
      margin-bottom:.6rem;
    }
    .hero-tags {
      display:flex;
      flex-wrap:wrap;
      gap:.35rem;
      font-size:.68rem;
    }
    .hero-pill {
      padding:.28rem .65rem;
      border-radius:999px;
      border:1px solid var(--border-subtle);
      background:var(--bg-soft);
      text-transform:uppercase;
      letter-spacing:.18em;
      color:var(--text-soft);
    }

    .hero-actions {
      display:flex;
      flex-wrap:wrap;
      gap:.5rem;
      margin-top:.5rem;
      margin-bottom:.2rem;
    }
    .btn-main {
      font-size:.74rem;
      text-transform:uppercase;
      letter-spacing:.18em;
      padding:.48rem 1.05rem;
      border-radius:999px;
      border:1px solid var(--neon-pink);
      background:linear-gradient(135deg,var(--neon-pink),var(--neon-purple));
      color:#020617;
      cursor:pointer;
      font-weight:650;
      box-shadow:0 0 18px rgba(236,72,153,.85);
      white-space:nowrap;
    }
    .btn-ghost {
      font-size:.72rem;
      text-transform:uppercase;
      letter-spacing:.18em;
      padding:.44rem .95rem;
      border-radius:999px;
      border:1px solid var(--border-subtle);
      background:var(--bg-soft);
      color:var(--text-soft);
      cursor:pointer;
      white-space:nowrap;
    }

    /* SECTIONS */
    .section {
      margin-bottom:1.1rem;
    }
    .section-title {
      font-size:.8rem;
      text-transform:uppercase;
      letter-spacing:.2em;
      color:var(--text-soft);
      margin-bottom:.45rem;
    }

    .card {
      border-radius:.9rem;
      border:1px solid var(--border-subtle);
      background:var(--bg-card);
      padding:.7rem .78rem .8rem;
      font-size:.76rem;
    }

    .list {
      border-radius:.8rem;
      border:1px solid var(--border-subtle);
      background:#020617;
      max-height:230px;
      overflow:auto;
      font-size:.74rem;
    }
    .row {
      padding:.42rem .58rem;
      border-bottom:1px solid rgba(15,23,42,0.92);
      display:flex;
      justify-content:space-between;
      gap:.4rem;
    }
    .row:nth-child(odd){
      background:rgba(15,23,42,0.95);
    }
    .row-main {
      flex:1;
    }
    .row-title {
      font-weight:600;
      margin-bottom:.02rem;
    }
    .row-sub {
      font-size:.7rem;
      color:var(--text-soft);
    }
    .row-meta {
      font-size:.68rem;
      color:var(--text-soft);
      margin-top:.12rem;
    }
    .row-right {
      min-width:4.8rem;
      text-align:right;
      font-size:.7rem;
      color:var(--text-soft);
    }
    .pill-small {
      display:inline-block;
      padding:.16rem .4rem;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.7);
      font-size:.62rem;
      text-transform:uppercase;
      letter-spacing:.14em;
    }
    .pill-small.hot {
      border-color:var(--neon-lime);
      color:var(--neon-lime);
    }
    .mono {
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    .note {
      margin-top:.7rem;
      font-size:.7rem;
      color:var(--text-soft);
    }
    .note code { color:var(--neon-cyan); }
  </style>
</head>
<body>
  <div class="shell">
    <header class="nav">
      <div class="nav-left">
        <div class="logo-orb">AD</div>
        <div class="brand-text">
          <div class="brand-kicker">They Krave For Me Radio</div>
          <div class="brand-main">Artist Drop Page</div>
        </div>
      </div>
      <nav class="nav-right">
        <a href="index.html" class="nav-pill">üè† Front Page</a>
        <a href="radio-hub.html" class="nav-pill primary">üìª Radio Hub</a>
        <a href="creator-pass.html" class="nav-pill">üé´ Creator Pass</a>
        <a href="fan-pass.html" class="nav-pill">‚≠ê Fan Pass</a>
      </nav>
    </header>

    <section class="hero">
      <div class="hero-kicker">Artist Drop</div>
      <h1 class="hero-title" id="heroArtist">Artist Name</h1>
      <p class="hero-sub" id="heroCopy">
        This page surfaces TKFM activity for this artist from uploads, hosted mixtapes and social campaigns
        ‚Äî so fans and labels can see their motion in one link.
      </p>
      <div class="hero-tags" id="heroTags">
        <div class="hero-pill">TKFM Uploads</div>
        <div class="hero-pill">Hosted Mixtapes</div>
        <div class="hero-pill">Social Pushes</div>
      </div>
      <div class="hero-actions">
        <button type="button" class="btn-main" id="btnListenRadio">Listen on TKFM</button>
        <button type="button" class="btn-ghost" id="btnSaveFocus">Set as Focus Artist on this Device</button>
      </div>
    </section>

    <section class="section">
      <div class="section-title">Recent TKFM uploads</div>
      <div class="list" id="listUploads">
        <!-- JS -->
      </div>
    </section>

    <section class="section">
      <div class="section-title">Hosted mixtapes</div>
      <div class="list" id="listMix">
        <!-- JS -->
      </div>
    </section>

    <section class="section">
      <div class="section-title">Social campaigns</div>
      <div class="list" id="listSocial">
        <!-- JS -->
      </div>
    </section>

    <p class="note">
      This Drop Page reads from your browser‚Äôs TKFM data:
      <code>artistUploads</code>, <code>mixtapeOrders</code> and
      <code>tkfm_social_campaigns</code>. When you move to a full database, you can power the exact same
      layout off server stats and share this link everywhere.
    </p>
  </div>

  <script>
    (function(){
      const KEY_UPLOADS = 'artistUploads';
      const KEY_MIX = 'mixtapeOrders';
      const KEY_SOCIAL = 'tkfm_social_campaigns';
      const KEY_FOCUS_ARTIST = 'tkfm_drop_focus_artist';

      function safeParse(key, fallback) {
        try {
          const raw = localStorage.getItem(key);
          if (!raw) return fallback;
          const v = JSON.parse(raw);
          if (v === null || typeof v === 'undefined') return fallback;
          return v;
        } catch(e) {
          console.warn('parse error', key, e);
          return fallback;
        }
      }

      function getQueryParam(name) {
        const params = new URLSearchParams(window.location.search);
        return params.get(name);
      }

      function normalize(str) {
        if (!str) return '';
        return String(str).trim().toLowerCase();
      }

      function formatTime(ts) {
        const d = new Date(ts);
        if (isNaN(d.getTime())) return '';
        return d.toLocaleString();
      }

      function filterByArtist(list, artist) {
        if (!Array.isArray(list)) return [];
        const target = normalize(artist);
        return list.filter(item => {
          return [
            item.artistName,
            item.creatorName,
            item.clientName,
            item.djName
          ].some(v => normalize(v) === target);
        });
      }

      function renderUploads(list) {
        const box = document.getElementById('listUploads');
        box.innerHTML = '';
        if (!list.length) {
          const div = document.createElement('div');
          div.className = 'row';
          div.textContent = 'No uploads found for this artist on this device yet.';
          box.appendChild(div);
          return;
        }
        list.slice().reverse().slice(0, 8).forEach(u => {
          const row = document.createElement('div');
          row.className = 'row';

          const main = document.createElement('div');
          main.className = 'row-main';

          const title = document.createElement('div');
          title.className = 'row-title';
          title.textContent = u.title || u.trackTitle || 'Uploaded Track';

          const sub = document.createElement('div');
          sub.className = 'row-sub';
          sub.textContent = (u.genre || 'Unknown genre') + ' ‚Ä¢ ' + (u.status || 'pending');

          const meta = document.createElement('div');
          meta.className = 'row-meta';
          meta.textContent = formatTime(u.createdAt || u.timestamp);

          main.appendChild(title);
          main.appendChild(sub);
          main.appendChild(meta);

          const right = document.createElement('div');
          right.className = 'row-right';
          const pill = document.createElement('span');
          pill.className = 'pill-small';
          pill.textContent = 'UPLOAD';
          right.appendChild(pill);

          row.appendChild(main);
          row.appendChild(right);
          box.appendChild(row);
        });
      }

      function renderMix(list) {
        const box = document.getElementById('listMix');
        box.innerHTML = '';
        if (!list.length) {
          const div = document.createElement('div');
          div.className = 'row';
          div.textContent = 'No hosted mixtape projects found for this artist on this device yet.';
          box.appendChild(div);
          return;
        }
        list.slice().reverse().slice(0, 6).forEach(o => {
          const row = document.createElement('div');
          row.className = 'row';

          const main = document.createElement('div');
          main.className = 'row-main';

          const title = document.createElement('div');
          title.className = 'row-title';
          const tier = o.tier || o.plan || 'Mixtape';
          title.textContent = tier + ' ‚Äî ' + (o.projectTitle || o.projectName || 'Hosted Project');

          const sub = document.createElement('div');
          sub.className = 'row-sub';
          sub.textContent = (o.status || 'pending') + ' ‚Ä¢ ' + (o.length || '');

          const meta = document.createElement('div');
          meta.className = 'row-meta';
          meta.textContent = formatTime(o.createdAt || o.timestamp);

          main.appendChild(title);
          main.appendChild(sub);
          main.appendChild(meta);

          const right = document.createElement('div');
          right.className = 'row-right';
          const pill = document.createElement('span');
          pill.className = 'pill-small hot';
          pill.textContent = 'MIXTAPE';
          right.appendChild(pill);

          row.appendChild(main);
          row.appendChild(right);
          box.appendChild(row);
        });
      }

      function renderSocial(list) {
        const box = document.getElementById('listSocial');
        box.innerHTML = '';
        if (!list.length) {
          const div = document.createElement('div');
          div.className = 'row';
          div.textContent = 'No TKFM social campaigns found for this artist on this device yet.';
          box.appendChild(div);
          return;
        }
        list.slice().reverse().slice(0, 6).forEach(c => {
          const row = document.createElement('div');
          row.className = 'row';

          const main = document.createElement('div');
          main.className = 'row-main';

          const title = document.createElement('div');
          title.className = 'row-title';
          title.textContent = (c.packageName || c.tier || 'Social Campaign') + ' ‚Äî ' + (c.platform || 'Multi-platform');

          const sub = document.createElement('div');
          sub.className = 'row-sub';
          sub.textContent = 'Status: ' + (c.status || 'active');

          const meta = document.createElement('div');
          meta.className = 'row-meta';
          meta.textContent = formatTime(c.createdAt || c.timestamp);

          main.appendChild(title);
          main.appendChild(sub);
          main.appendChild(meta);

          const right = document.createElement('div');
          right.className = 'row-right';
          const pill = document.createElement('span');
          pill.className = 'pill-small';
          pill.textContent = 'SOCIAL';
          right.appendChild(pill);

          row.appendChild(main);
          row.appendChild(right);
          box.appendChild(row);
        });
      }

      function initDropPage() {
        const artistParam = getQueryParam('artist');
        const heroArtist = document.getElementById('heroArtist');
        const heroCopy = document.getElementById('heroCopy');

        const artistName = artistParam || 'Unknown Artist';
        if (heroArtist) heroArtist.textContent = artistName;
        if (heroCopy && artistParam) {
          heroCopy.textContent = artistName + ' ‚Äî TKFM Drop Page. This link pulls uploads, hosted mixtapes and social pushes tied to this name on this device.';
        }

        const uploads = safeParse(KEY_UPLOADS, []);
        const mixOrders = safeParse(KEY_MIX, []);
        const social = safeParse(KEY_SOCIAL, []);

        const u = filterByArtist(uploads, artistName);
        const m = filterByArtist(mixOrders, artistName);
        const s = filterByArtist(social, artistName);

        renderUploads(u);
        renderMix(m);
        renderSocial(s);

        const btnListen = document.getElementById('btnListenRadio');
        if (btnListen) {
          btnListen.addEventListener('click', function(){
            window.location.href = 'radio-hub.html';
          });
        }

        const btnFocus = document.getElementById('btnSaveFocus');
        if (btnFocus) {
          btnFocus.addEventListener('click', function(){
            localStorage.setItem(KEY_FOCUS_ARTIST, artistName);
            alert('Set "' + artistName + '" as focus artist on this device. You can use this in radio tools later.');
          });
        }
      }

      window.addEventListener('DOMContentLoaded', initDropPage);
    })();
  </script>
</body>
</html>
